---
---
---

# **Project CLV Sebastian Lemos**

#### ID TI1007335 group ABD-07

## 

### **Customer Lifetime Value**

Customer lifetime value (CLV) is a business metric that measures how much a business can plan to earn from the average customer over the course of the relationship. Differences in products, costs, purchase frequencies and purchase volumes can make customer lifetime value calculations complex.

Customer lifetime value (CLV) is a measure of the total income a business can expect to bring in from a typical customer for as long as that person or account remains a client.

When measuring CLV, it's best to look at the total average revenue generated by a customer and the total average profit. Each provides important insights into how customers interact with your business and if your overall marketing plan is working as expected.

![](images/image-631035300.png){width="681"}

![](images/image-456225878.png)

Use the below reference links to understand how to calculate CLV and write a report on visiting Tim Hortons.

You started drinking coffee from Tim Horton's since January 2020 an average you spend \$6.45 each visit 3 time during the week to Tim Hortons till now. Calculate CLV with .

**Exercise 1 :**

Write down the step involved in solving the above question.

1)  First we have to do is understand the mathematical formula for calculate the CLV

**CLV = AARPC \* ALC**

###### where:

###### CLV -\> Customer lifetime value

###### AARPC -\> Average annual revenue per customer

###### ALC -\> Average Lifetime of customers

2)  Identify the variables involve on the problem we have to solve:

a ) Average spending for visit = \$6.45

b)  Recurrence of visits = 3 times a week

c)  Average spending for week = \$6.45 \* 3 = \$19.35

d)  Weeks a year = 365/7 = 52.14

e)  Average spending a year = \$19.35 \* 52.14 = \$1,008.96

f)  AARPC = Average spending a year per customer \* number of customers = \$1,008.96 \* 1 = \$1,008.96

g)  ALC = (Today's date - Starting date)/365 = (#15/03/2023# - #01/01/2020#)/365 = 3.2 years

h)  CLV = 1,008.96 \* 3.2 = \$3,231.45

```{r}
#Function CLV
CLV <- function(AARPC, ALC){
  CLV = AARPC * ALC
  as.numeric(return(CLV))
}
# Variables declaration
Avarage_spending_per_visit<- 6.45
Recurrence_of_visits<- 3
Numer_of_customers<- 1
weeks_a_year = 365/7
Today_date <- as.Date('2023-03-15')
Starting_date <- as.Date("2020-01-01")

# calculations
Average_spending_per_week<-Avarage_spending_per_visit * Recurrence_of_visits
Avarage_spending_a_year <- weeks_a_year * Average_spending_per_week
AARPC <- Avarage_spending_a_year * Numer_of_customers
ALC<- as.numeric(difftime(Today_date, Starting_date, units = "days")/365)
#executing the function CLV
CLV(AARPC,ALC)
```

**Exercise 2 :**

Use the data and calculate the CLV by adding the profit margin of 25%.

In order to complete the task we must re understand the CLV Formula by adding to it the concept of profit margin. To do so we must resort to a definition given by one of the references of the exercise which says that gross margin is the same concept as profit margin.

"AGM is the average gross margin, which tells you what part of each sale is your actual profit..."

![](images/image-2034583868.png)

##### Source : <https://medium.com/swlh/5-simple-ways-to-calculate-customer-lifetime-value-5f49b1a12723>

Now, using this concept and assuming that the cost of sales remains the same or fixed regardless of the number of products sold, we could deduce that adding 25% to the gross margin would be the same as adding 25% to the price of the products, which leads us to determine that adding 25% to the total revenue would be adding 25% to the gross margin or profit margin.

Now that we clarify the concept of CLV we could continue with the exercise by importing the data given to us to work.

```{r}
Base_ventas <- read.csv("G:/Mi unidad/trebas info/customer_eval2.csv")

```

Then we evaluate the data imported structure and make changes if necesary

```{r}
str(Base_ventas)
```

In this case, everything seems to be good, because the data is a data frame, columns Quantity and UnitPrice are numeric, and the dimension of the data base is correct. so we could proceed next.

Then, we must fix the data:

```{r}

library(dplyr)
library(tidyr)

#We first use a filter to delete rows with NA on column Quantity because without that information is impossible to work

#Then we separate the information By groups attached to the column "description" 

#Finally, we replace NA from column UnitPrice with the average figure of the correspondent group

Base_ventas_fixed <- Base_ventas %>% 
  filter(!is.na(Base_ventas$Quantity))%>%
  group_by(Description) %>% 
  mutate_at(vars(UnitPrice), ~replace_na(., mean(., na.rm = TRUE)))
Base_ventas_fixed

```

Once we have fixed the data base we could ad a new column adding 25% to the unit price, and other calculating the total sales.

```{r}

Base_ventas_fixed$New_unit_price <- Base_ventas_fixed$UnitPrice *1.25
Base_ventas_fixed$Total_sales <- Base_ventas_fixed$New_unit_price*Base_ventas_fixed$Quantity

```

Now we can calculate the CVL taking under consideration the sample we have only covers one day of the year 12/1/2010, Then we have to assume that total_sales on the sample is equal to average daily sales on the population, and make the assumption the enterprise make sales every day of the year

```{r}
#calculations
Numer_of_customers<- n_distinct(Base_ventas_fixed$CustomerID)
Avarage_spending_a_year <- sum(Base_ventas_fixed$Total_sales) / Numer_of_customers
AARPC <-  Avarage_spending_a_year * Numer_of_customers
ALC <- 1/365

#executing the function CLV
CLV(AARPC,ALC)
```

**Exercise 3 :**

Evaluate the CLV for following customer, whose purchases for two year is more than 2000

For giving answer to this question we need create a new data base resumed by ID client, with the averages sales of each customer. and then multiply it for 730 days, and finally make a filter so check which customer has more than 2,000 in the final result.

```{r}

Base_resumida <- Base_ventas_fixed%>%
  group_by(CustomerID) %>%
  summarize(mean_sales = mean(Total_sales))

Base_resumida$TwoYearAvSales <- Base_resumida$mean_sales * 730

Base_resumida_filtrada <- Base_resumida%>%
  filter(Base_resumida$TwoYearAvSales> 2000)
Base_resumida_filtrada

paste("Acording to the result we could say that ", length(Base_resumida_filtrada$CustomerID), "out of ",length(Base_resumida$CustomerID), "Customers have a two-year CLV above $2,000")

```
